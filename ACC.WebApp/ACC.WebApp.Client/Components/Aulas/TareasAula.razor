@using ACC.Shared.DTOs 
@rendermode InteractiveServer
<div class="tareas-wrapper">
    <h3>Tareas</h3>
    <button class="crear-btn" @onclick="NuevaTarea">+ Nueva tarea</button>

    @if (mostrarFormulario)
    {
        <div class="tarea-form">
            <input type="text" placeholder="TÃ­tulo" @bind="tareaActual.TituloTareaAsignada" />
            <select @bind="tareaActual.Completada">
                <option value="true">Completada</option>
                <option value="false">Sin Completar</option>
            </select>
            <input type="date" @bind="tareaActual.FechaLimiteTareaAsignada" />
            <div class="acciones">
                <button @onclick="Guardar">Guardar</button>
                <button class="secundario" @onclick="Cancelar">Cancelar</button>
            </div>
        </div>
    }

    @foreach (var tarea in tareas)
    {
        <div class="tarea-item">
            <span class="titulo">@tarea.TituloTareaAsignada</span>
            <span class="estado">@tarea.Completada</span>
            <span class="fecha">@tarea.FechaLimiteTareaAsignada.ToString("dd/MM/yyyy HH:mm")</span>
        </div>
    }
</div>

@code {
    private List<TareaAsignadaDto> tareas = new();
    private TareaAsignadaDto tareaActual = new();
    private bool mostrarFormulario;
    private bool editando;

    private void NuevaTarea()
    {
        tareaActual = new TareaAsignadaDto();
        editando = false;
        mostrarFormulario = true;
    }

    private void Guardar()
    {
        if (!editando)
        {
            tareas.Add(tareaActual);
        }
        mostrarFormulario = false;
    }

    private void Cancelar()
    {
        mostrarFormulario = false;
    }
}